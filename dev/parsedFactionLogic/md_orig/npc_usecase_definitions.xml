<?xml version="1.0" encoding="utf-8"?>
<mdscript name="NPC_UseCase_Definitions" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
  <cues>

    <!-- NPC use case definitions: Included from NPC_UseCases -->
    <library name="AddUseCaseDefs">
      <actions>
        <!-- Usecase table entries:
          $name                     Usecase name to be referenced by usecase trigger (required)
          $version                  Current version of the usecase (default is 0)
          $mincompatibleversion     Minimum compatible version - when loading a savegame, currently active usecases are aborted if incompatible (see above) (default is 0)
          $priority                 Usecase priority, can be overridden by trigger - NPCs are only available for this usecase if not already active in another usecase of same or higher priority
                                    (NOTE: A lower-priority usecase gets aborted if an involved NPC is re-assigned to a higher-priority usecase, if the NPC is not marked as $passive in either usecase)
          $chance                   Chance percentage of a trigger triggering this usecase (default is 100)
          $repeattimeout            Time interval after the usecase was active in which the usecase may not become active again
          $queue                    In case the usecase cannot be started immediately due to one or more usecases that are already running, queue the usecase for later (ordered by priority)
                                    (NOTE: This does not prevent the usecase from being aborted by a higher-priority usecase after start)
          $exclusive                Set to true to make sure no other exclusive usecase can run at the same time
          $noconversation           Set to true to prevent this usecase from starting while a player conversation is active (does not prevent conversation while usecase is running!)
          $nofullscreenmenu         Set to true to prevent this usecase from starting while a fullscreen menu is open (does not prevent fullscreen menu while usecase is running!)
          $voiceover                Set to true to let NPCs speak with normal voice, maximal volume and maximal speak priority, to be used in cinematic cutscenes
          $speakpriority            Global speak priority for any speech in the usecase (0-99, default is 0)
          $validatespeak            Set to true to print an error if a speak is triggered with an invalid line (default is true for regular usecases, false for custom usecases)
          $locations                List of location names, to be referenced by actors (required)
          $actors                   List of actor definitions (required)
          $script                   Usecase script (either $script or $selectscript must be provided)
          $selectscript             List of tables with entries $script, $weight (optional), $filter (optional) for dynamic script selection (either $script or $selectscript must be provided)
        -->

        <!-- $Example: FULL EXAMPLE with most supported features -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Example',
            $version = 7, $mincompatibleversion = 5,
            $priority = 10, $chance = 100, $repeattimeout = 2s, $noconversation = true, $nofullscreenmenu = true, $queue = false, $exclusive = true, $voiceover = false, $speakpriority = 0, $validatespeak = true,
            $locations = [ '$Bridge', '$Station' ],
            $actors = [
              table[ $name = '$Captain',  $location = '$Bridge',  $filter = [controlpost.aipilot, attention.inroom], $allow_player = true, $monitor = table[ $forceonplayer = true ] ],
              table[ $name = '$Service1', $location = '$Bridge',  $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true, $monitor = true ],
              table[ $name = '$Service2', $location = '$Bridge',  $filter = [entityrole.service, controlposition.comms, class.ship_l], $passive = true, $optional = true ],
              table[ $name = '$Service3', $location = '$Bridge',  $filter = [entityrole.service, controlposition.gunner], $allow_walk_to_position = true, $optional = true ],
              table[ $name = '$ServiceX', $location = '$Bridge',  $filter = [entityrole.service], $allow_duplicate_actor = true, $excludefilter = [controlposition.navigation], $optional = true ],
              table[ $name = '$Manager',  $location = '$Station', $filter = [controlpost.manager], $allow_computer = true ],
            ],
            $selectscript_EXAMPLE = [
              table[ $weight = 60, $filter = table[$Service1=true], $script = [] ],
              table[ $weight = 40, $script = [] ],
            ],
            $script = [
              table[ $actor = '$Service1', $walkto = controlposition.comms, $skipafter = 10s ],
              table[ $actor = '$Captain', $templookat = '$Service1', $emotion = 'smile', $speak = 456, $filter = table[$Service1=true, $Service2=[controlposition.navigation]], $excludefilter = table[$Service3=true] ],
              table[ $actor = '$Service1', $lookat = '$Captain', $emotion = 'rolleyes01', $excludefilter = table[$Captain=[class.ship_xl, class.player]] ],
              table[ $actor = '$ServiceX', $lookat = '$Service2', $comment = 'random service person starts looking at $Service2 (unless the two actors are identical)' ],
              1s,
              table[ $lookat = null, $emotion = null ],
              table[ $actor = '$Service1', $runto = controlposition.navigation, $abortafter = 10s ],
              table[ $actor = '$Manager', $lookat = 'player', $chance = 20 ],
              table[ $closemonitor = true ],
              table[ $select = [
                table[ $weight = 60, $actor = '$Captain', $speak = [10101,100], $recipient = 'player', $broadcast = false, $speakcallbackparam = 'captain_has_spoken', $comment = 'callback happens if trigger specifies $speakcallbackcue' ],
                table[ $weight = 20, $actor = '$Captain', $speak = 200, $speakdelay = 0.5s, $speakemotion = [0.3, 'angry'], $recipient = '$Captain', $allow_comm_chatter = true, $allow_player_speak = true ],
                table[ $weight = 10, $actor = '$Captain', $speak_to_male = 501, $speak_to_female = 502, $recipient = 'player', $comment = 'Select speak line based on gender of recipient' ],
                table[ $weight = 10, $actor = '$Captain', $selectspeak_to_male = [501, 511], $selectspeak_to_female = [502, 512], $recipient = 'player', $comment = 'Same with $selectspeak_' ],
              ] ],
              5s,
              table[ $actor = '$Manager', $selectspeak = [ 457, 458, [10101,459] ], $validatespeak = false, $tempemotion = 'angry' ],
            ]
          ]" />

        <!-- $Test1 (test usecase) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Test1',
            $priority = 10, $chance = 100, $repeattimeout = 2s,
            $locations = [ '$Bridge', '$Station' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Service1', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              0.2s,
              table[ $actor = '$Service1', $runto = controlposition.navigation ],
              table[ $actor = '$Captain', $lookat = '$Service1', $speak = 2003 ],
              table[ $actor = '$Service1', $lookat = '$Captain', $speak = 2004, $emotion = 'smile' ],
              table[ $actor = '$Captain', $speak = 2010 ],
            ]
          ]" />

        <!-- Two nearby characters shortly looking at each other -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$MeetAndGreet',
            $priority = 0, $chance = 100, $repeattimeout = 3min,
            $locations = [ '$Location' ],
            $actors = [
              table[ $name = '$Actor1', $location = '$Location', $filter = [ attention.adjacentroom ], $excludefilter = [ 'ismissionactor' ] ],
              table[ $name = '$Actor2', $location = '$Location', $filter = [ attention.adjacentroom ], $excludefilter = [ 'ismissionactor' ], $allow_player = true ],
            ],
            $script = [
              table[ $actor = '$Actor1', $lookat = '$Actor2' ],
              table[ $actor = '$Actor1', $selectspeak = [2001, 2002], $comment = '(Greeting - neutral)' ],
              table[ $actor = '$Actor2', $lookat = '$Actor1' ],
              0.1s,
              table[ $actor = '$Actor2', $selectspeak = [2001, 2002], $comment = '(Greeting - neutral)' ],
              2s,
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$MeetAndGreetCommander',
            $priority = 0, $chance = 100, $repeattimeout = 150s,
            $locations = [ '$Location' ],
            $actors = [
              table[ $name = '$Actor1', $location = '$Location', $filter = [ attention.adjacentroom ], $excludefilter = [ 'ismissionactor' ] ],
              table[ $name = '$Actor2', $location = '$Location', $filter = [ attention.adjacentroom ], $excludefilter = [ 'ismissionactor' ], $allow_player = true ],
            ],
            $script = [
              table[ $actor = '$Actor1', $lookat = '$Actor2' ],
              table[ $actor = '$Actor1', $speak_to_male = 3001, $speak_to_female = 3002, $comment = '(Greeting - boss)' ],
              table[ $actor = '$Actor2', $lookat = '$Actor1' ],
              0.1s,
              table[ $actor = '$Actor2', $speak_to_male = 3011, $speak_to_female = 3012, $comment = '(Greeting - crew)' ],
              2s,
            ]
          ]" />

        <!-- Captain on bridge giving command to navigation crewman -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$BridgeNavOrder',
            $priority = 50, $chance = 100, $repeattimeout = 10min,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot, attention.inroom] ],
              table[ $name = '$Nav', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 5018, $comment = 'We have new orders.' ],
              table[ $actor = '$Captain', $speak = 3122, $templookat = '$Nav', $comment = 'Navigation!' ],
              table[ $actor = '$Nav', $runto = controlposition.navigation, $speak_TODO_ENABLE = 5019, $recipient = '$Captain', $abortafter = 20s, $comment = 'On the way. (TODO: Only if not at post yet)' ],
              table[ $actor = '$Nav', $lookat = '$Captain' ],
              table[ $actor = '$Captain', $speak = 10419, $lookat = '$Nav', $comment = 'Fly to the following position. (TODO: Add typing on terminal)' ],
              table[ $actor = '$Nav', $selectspeak = [2103, 2104, 2105], $comment = 'acknowledgement (TODO: Add typing on terminal)' ],
            ]
          ]" />

        <!-- Navigation crewman on bridge announcing jump gate approach -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$BridgeNavApproachJumpGate',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot, attention.inroom] ],
              table[ $name = '$Nav', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Nav', $runto = controlposition.navigation, $abortafter = 20s ],
              table[ $actor = '$Nav', $speak = 10415, $templookat = '$Captain', $comment = 'Approaching Jump Gate.' ],
            ]
          ]" />

        <!-- Navigation crewman on bridge announcing superhighway approach -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$BridgeNavApproachSuperHWGate',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot, attention.inroom], $passive = true ],
              table[ $name = '$Nav', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Nav', $runto = controlposition.navigation, $abortafter = 20s ],
              table[ $actor = '$Nav', $speak = 10413, $templookat = '$Captain', $comment = 'Approaching superhighway.' ],
            ]
          ]" />

        <!-- Navigation crewman on bridge announcing transorbital accelerator approach -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$BridgeNavApproachAccelerator',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot, attention.inroom], $passive = true ],
              table[ $name = '$Nav', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Nav', $runto = controlposition.navigation, $abortafter = 20s ],
              table[ $actor = '$Nav', $speak = 10414, $templookat = '$Captain', $comment = 'Approaching accelerator.' ],
            ]
          ]" />

        <!-- Navigation crewman on bridge announcing travel drive activation -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$BridgeNavTravelDrive',
            $priority = 30, $chance = 100, $repeattimeout = 3min,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot, attention.inroom], $passive = true ],
              table[ $name = '$Nav', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Nav', $runto = controlposition.navigation, $abortafter = 20s ],
              table[ $actor = '$Nav', $speak = 5006, $templookat = '$Captain', $comment = 'Activating travel mode.' ],
            ]
          ]" />

        <!-- Captain orders to dock, navigation crewman gets dock permission -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$BridgeStartDocking',
            $priority = 30, $chance = 100, $repeattimeout = 3min,
            $locations = [ '$Bridge', '$Station' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Nav', $location = '$Bridge', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
              table[ $name = '$Manager', $location = '$Station', $filter = [controlpost.manager], $optional = true ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 3122, $templookat = '$Nav', $comment = 'Navigation!' ],
              table[ $actor = '$Nav', $runto = controlposition.navigation, $speak_TODO_ENABLE = 5019, $recipient = '$Captain', $require_inroom = true, $abortafter = 20s, $comment = 'On the way. (TODO: Only if not at post yet)' ],
              table[ $actor = '$Nav', $lookat = '$Captain' ],
              table[ $actor = '$Captain', $speak = 4021, $lookat = '$Nav', $comment = 'Prepare to dock.' ],
              table[ $actor = '$Nav', $selectspeak = [2103, 2104, 2105], $comment = 'acknowledgement' ],
              table[ $actor = '$Captain', $lookat = null ],
              table[ $actor = '$Nav', $speak = 10702, $lookat = '$Manager', $comment = 'Requesting permission to dock.' ],
              table[ $actor = '$Manager', $speak = 10704, $lookat = '$Nav', $comment = 'Docking permission granted.' ],
              table[ $actor = '$Captain', $selectspeak = [10714, 10725], $speakdelay = 750ms, $lookat = '$Nav', $comment = 'Bring us into dock. / Bring the ship in slowly.' ],
              table[ $actor = '$Nav', $selectspeak = [2103, 2104, 2105], $lookat = '$Captain', $comment = 'acknowledgement' ],
            ]
          ]" />

        <!-- ***** Combat ***** -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Carrier_Scramble',
            $priority = 20, $chance = 100, $repeattimeout = 10min,
            $locations = [ '$CarrierBridge', '$SubordinateBridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$CarrierBridge', $filter = [controlpost.aipilot, 'cantalk'], $allow_player = true  ],
              table[ $name = '$Subordinate', $location = '$SubordinateBridge', $filter = [controlpost.aipilot, 'cantalk'], $allow_player = true, $allow_computer = true ],
            ],
            $script = [
              table[ $actor = '$Captain', $templookat = '$Subordinate', $selectspeak = [10044], $comment = 'New attack orders!' ],
              table[ $actor = '$Captain', $templookat = '$Subordinate', $speak = 4015, $comment = 'Scramble' ],
              table[ $actor = '$Subordinate', $templookat = '$Captain', $selectspeak = [5019, 2103, 2104, 2105], $comment = 'on the way, acknowledgement' ],
            ]
          ]" />
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Carrier_Scramble_Verbose',
            $priority = 20, $chance = 100, $repeattimeout = 10min,
            $locations = [ '$CarrierBridge', '$SubordinateBridge', '$SubsubordinateBridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$CarrierBridge', $filter = [controlpost.aipilot, 'cantalk'], $allow_player = true  ],
              table[ $name = '$Subordinate', $location = '$SubordinateBridge', $filter = [controlpost.aipilot, 'cantalk'], $allow_player = true, $allow_computer = true ],
              table[ $name = '$Subsubordinate', $location = '$SubsubordinateBridge', $filter = [controlpost.aipilot, 'cantalk'], $allow_player = true, $allow_computer = true ],
            ],
            $script = [
              table[ $actor = '$Captain', $templookat = '$Subordinate', $selectspeak = [3119], $comment = 'Group Leader!' ],
              table[ $actor = '$Captain', $templookat = '$Subordinate', $selectspeak = [4015], $comment = 'Scramble' ],
              table[ $actor = '$Subordinate', $templookat = '$Captain', $selectspeak = [5019, 2103, 2104, 2105], $comment = 'on the way, acknowledgement' ],
              table[ $actor = '$Subordinate', $templookat = '$Subsubordinate', $selectspeak = [10501], $comment = 'this is group leader' ],
              table[ $actor = '$Subordinate', $templookat = '$Subsubordinate', $selectspeak = [10043, 10044], $comment = 'we have new attack orders!' ],
              table[ $actor = '$Subordinate', $templookat = '$Subsubordinate', $selectspeak = [5030, 10509, 10045], $comment = 'Be prepared for combat encounters / you are free to engage / prepare to open fire on the target' ]
            ]
          ]" />

        <!-- NOTE: This usecase is only triggered if attacker is player-owned or if the player is on the bridge of the attacked ship -->
        <!-- TODO: Actor-specific usecase timeout on captain (45s?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_Warning',
            $priority = 20, $chance = 100, $repeattimeout = 20s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $monitor = true, $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Engineer', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.engineering, attention.inroom], $optional = true ],
              table[ $name = '$Comms', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.comms, attention.inroom], $passive = true, $optional = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Engineer', $templookat = '$Captain', $selectspeak = [10004, 10005, 10006], $comment = 'multi-crew ship hit without taking serious damage / we were hit' ],
              table[ $actor = '$Captain', $templookat = '$Comms', $speak = 4023, $filter = table[$Captain = [attention.inroom]], $comment = 'Open comms.' ],
              0.3s,
              table[ $actor = '$Captain', $selectspeak = [7001, 7002], $recipient = '$Attacker', $comment = 'first warning to attacking ship / Stop your attack immediately.' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_Flee',
            $priority = 30, $chance = 100, $repeattimeout = 3min,
            $locations = [ '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Nav', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.navigation], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 3122, $templookat = '$Nav', $comment = 'Navigation!' ],
              table[ $actor = '$Nav', $runto = controlposition.navigation, $speak_TODO_ENABLE = 5019, $recipient = '$Captain', $require_inroom = true, $abortafter = 20s, $comment = 'On the way. (TODO: Only if not at post yet)' ],
              table[ $actor = '$Nav', $lookat = '$Captain' ],
              table[ $actor = '$Captain', $speak = 5015, $lookat = '$Nav', $comment = 'Get us out of here!' ],
              table[ $actor = '$Nav', $selectspeak = [2103, 2104, 2105], $lookat = '$Captain', $comment = 'acknowledgement' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_ReportNormalDamage',
            $priority = 20, $chance = 50, $repeattimeout = 1min,
            $locations = [ '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.inroom] ],
              table[ $name = '$Engineer', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.engineering], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Engineer', $runto = controlposition.engineering, $skipafter = 0s ],
              table[ $actor = '$Captain', $chance = 10, $speak = 11502, $comment = 'Sit-rep!' ],
              table[ $actor = '$Engineer', $runto = controlposition.engineering, $skipafter = 10s, $comment = 'finish the walk, if not finished yet' ],
              table[ $actor = '$Captain', $lookat = '$Engineer' ],
              table[ $actor = '$Engineer', $templookat = '$Captain', $selectspeak = [10004, 10005, 10006], $comment = 'multi-crew ship hit without taking serious damage' ],
            ]
          ]" />

        <!-- TODO: Actor-specific usecase timeout on captain (3min?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_ReportDanger',
            $priority = 20, $chance = 100, $repeattimeout = 45s,
            $locations = [ '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.inroom] ],
              table[ $name = '$Engineer', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.engineering], $allow_walk_to_position = true ],
            ],
            $script = [
              table[ $actor = '$Engineer', $runto = controlposition.engineering, $skipafter = 0s ],
              table[ $actor = '$Captain', $speak = 11502, $comment = 'Sit-rep!', $chance = 20 ],
              table[ $actor = '$Engineer', $runto = controlposition.engineering, $skipafter = 10s, $comment = 'finish the walk, if not finished yet' ],
              table[ $actor = '$Captain', $lookat = '$Engineer' ],
              table[ $actor = '$Engineer', $templookat = '$Captain', $selectspeak = [10007, 10008], $comment = 'multi-crew ship hit, serious threat' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_ReportShieldsDown',
            $priority = 20, $chance = 100, $repeattimeout = 3min,
            $locations = [ '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.inroom], $allow_player = true ],
              table[ $name = '$Engineer', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.engineering], $allow_walk_to_position = true ],
            ],
            $script = [
                table[ $actor = '$Engineer', $runto = controlposition.engineering, $skipafter = 10s, $comment = 'finish the walk, if not finished yet' ],
                table[ $actor = '$Engineer', $templookat = '$Captain', $selectspeak = [11506], $comment = '11506 Shields are down' ],
            ]
          ]" />

        <!-- NOTE: Lines 10024 and 10025 turned out to be not generic enough to be used here -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_PleadForLife',
            $priority = 25, $chance = 100, $repeattimeout = 2min,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Comms', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.comms, attention.inroom], $passive = true, $optional = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $optional = true ],
            ],
            $script = [
              0.3s,
              table[ $actor = '$Captain', $selectspeak = [10026, 10027], $recipient = '$Attacker', $comment = 'multi-crew ship hit, life threat' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Large_Attacked_CallingForHelp',
            $priority = 20, $chance = 100, $repeattimeout = 45s,
            $locations = [ '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Captain', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Comms', $location = '$AttackedLocation', $filter = [entityrole.service, controlposition.comms, attention.inroom], $passive = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Captain', $templookat = '$Comms', $speak = 4024, $filter = table[$Captain = [attention.inroom]], $comment = 'Open comms!' ],
              0.3s,
              table[ $actor = '$Captain', $selectspeak = [10602], $broadcast = true, $comment = 'Requesting immediate backup!' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Escort_Spotted_Pirate',
            $priority = 20, $chance = 100, $repeattimeout = 125s,
            $locations = [ '$SpotterBridge', '$LeaderBridge', '$EnemyBridge' ],
            $actors = [
              table[ $name = '$Spotter', $location = '$SpotterBridge', $filter = [controlpost.aipilot, attention.visible, 'cantalk']],
              table[ $name = '$Leader', $location = '$LeaderBridge', $filter = [controlpost.aipilot], $allow_player = true, $optional = true ],
              table[ $name = '$Enemy', $location = '$EnemyBridge', $filter = [controlpost.aipilot]]
            ],
            $script = [table[ $actor = '$Spotter', $speak = 10054, $recipient = '$Leader', $comment = 'Pirate spotted!' ]]
          ]" />
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Escort_Spotted_Hostile',
            $priority = 20, $chance = 100, $repeattimeout = 125s,
            $locations = [ '$SpotterBridge', '$LeaderBridge', '$EnemyBridge' ],
            $actors = [
              table[ $name = '$Spotter', $location = '$SpotterBridge', $filter = [controlpost.aipilot, attention.visible, 'cantalk']],
              table[ $name = '$Leader', $location = '$LeaderBridge', $filter = [controlpost.aipilot], $allow_player = true, $optional = true ],
              table[ $name = '$Enemy', $location = '$EnemyBridge', $filter = [controlpost.aipilot]]
            ],
            $selectscript = [
              table[ $filter = table[$Enemy=[race.xenon]],
                     $script = [
                       table[ $actor = '$Spotter', $speak = 10052, $recipient = '$Leader', $comment = 'Xenon spotted!', $excludefilter = table[$Enemy = ['hasrenamedownerfaction']] ],
                       table[ $actor = '$Spotter', $speak = 10001, $recipient = '$Leader', $comment = 'Enemy spotted!', $filter = table[$Enemy = ['hasrenamedownerfaction']] ],
                     ],
                   ],
              table[ $filter = table[$Enemy=[race.khaak]],
                     $script = [table[ $actor = '$Spotter', $speak = 10053, $recipient = '$Leader', $comment = 'Khaak spotted!' ]]
                   ],
              table[ $excludefilter = table[$Enemy=[race.xenon, race.khaak]],
                     $script = [table[ $actor = '$Spotter', $speak = 10001, $recipient = '$Leader', $comment = 'Enemy spotted!' ]]
                   ]
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Escort_Engaging',
            $priority = 21, $chance = 100, $repeattimeout = 25s,
            $locations = [ '$SpotterBridge', '$LeaderBridge' ],
            $actors = [
              table[ $name = '$Spotter', $location = '$SpotterBridge', $filter = [controlpost.aipilot, attention.visible, 'cantalk'] ],
              table[ $name = '$Leader', $location = '$LeaderBridge', $filter = [controlpost.aipilot], $allow_player = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Spotter', $selectspeak = [10039, 10040], $recipient = '$Leader', $comment = 'Engaging/Striking!' ]
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Rescue_Come_Aboard',
            $priority = 80, $chance = 100, $repeattimeout = 25s,
            $locations = [ '$RescuerCockpit', '$StrandedSuit' ],
            $actors = [
              table[ $name = '$Rescuer', $location = '$RescuerCockpit', $filter = [controlpost.aipilot, attention.visible, 'cantalk'], $monitor = true ],
              table[ $name = '$Stranded', $location = '$StrandedSuit', $filter = [controlpost.aipilot], $allow_player = true, $passive = true ]
            ],
            $script = [
              table[ $actor = '$Rescuer', $recipient = '$Stranded', $speak = 10706, $comment = 'Please follow directions to designated docking position.' ]
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Rescue_Docking_At_Player',
            $priority = 1, $chance = 100, $repeattimeout = 5min,
            $locations = [ '$StrandedSuit' ],
            $actors = [
              table[ $name = '$Stranded', $location = '$StrandedSuit', $filter = [controlpost.aipilot, attention.visible, 'cantalk'], $monitor = true ]
            ],
            $script = [
              table[ $actor = '$Stranded', $recipient = 'player', $selectspeak = [2110, 2111], $comment = '(really grateful)Thanks for your help.' ],
              table[ $actor = '$Stranded', $recipient = 'player', $speak = 10713, $comment = 'Preparing to dock.' ]
            ]
          ]" />

        <!-- TODO: Actor-specific usecase timeout on $Attacked (30s?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacker_Taunt',
            $priority = 20, $chance = 100, $repeattimeout = 50s,
            $locations = [ '$AttackerLocation', '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot], $allow_player = true, $allow_computer = true ],
            ],
            $selectscript = [
              table[ $weight = 100, $filter = table[$Attacked=['cantalk']], $comment = 'Taunting enemy that can talk (player or NPC with speaker page)', $script = [
                table[ $actor = '$Attacker', $selectspeak = [10020, 10021, 10022, 10023], $recipient = '$Attacked', $comment = 'taunt line - response-capable' ],
                table[ $actor = '$Attacked', $excludefilter = table[$Attacked=['iscapitalship', class.station]], $selectspeak = [10068, 10069, 10070, 10071], $recipient = '$Attacker', $chance = 80, $comment = 'response to taunt - small ship' ],
              ] ],
              table[ $weight = 100, $excludefilter = table[$Attacked=['cantalk', race.xenon]], $comment = 'Taunting non-talking non-Xenon enemy', $script = [
                table[ $actor = '$Attacker', $selectspeak = [10022, 10023, 10075], $recipient = '$Attacked', $comment = 'taunt line - silent enemy' ],
              ] ],
              table[ $weight = 100, $filter = table[$Attacked=[race.xenon]], $comment = 'Taunting Xenon enemy', $script = [
                table[ $actor = '$Attacker', $selectspeak = [10022, 10023, 10074, 10075], $recipient = '$Attacked', $comment = 'taunt line - xenon' ],
              ] ],
            ]
          ]" />

        <!-- TODO: Actor-specific usecase timeout on $Attacked (15s?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_FriendlyFire',
            $priority = 20, $chance = 100, $repeattimeout = 2min,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible], $monitor = true, $allow_player = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $monitor = true, $allow_player = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Attacked', $selectspeak = [10047, 10048, 10049], $recipient = '$Attacker', $comment = 'reaction to friendly fire' ],
              0.1s,
              table[ $actor = '$Attacker', $selectspeak = [10073], $recipient = '$Attacked', $chance = 70, $comment = 'apology for friendly fire' ],
            ]
          ]" />

        <!-- TODO: Actor-specific usecase timeout on $Attacked (30s?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_Confident',
            $priority = 20, $chance = 100, $repeattimeout = 60s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible], $monitor = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $allow_computer = true ],
            ],
            $selectscript = [
              table[ $weight = 100, $filter = table[$Attacker=['cantalk']], $comment = 'Attacked by enemy that can talk (player or NPC with speaker page)', $script = [
                table[ $actor = '$Attacked', $selectspeak = [10057, 10058, 10059], $recipient = '$Attacker', $comment = 'single-crew ship hit without taking serious damage - response-capable' ],
                table[ $actor = '$Attacker', $excludefilter = table[$Attacker=['iscapitalship', class.station]], $selectspeak = [10064], $recipient = '$Attacked', $chance = 50, $comment = 'response - small ship' ],
                table[ $actor = '$Attacker', $filter = table[$Attacker=['iscapitalship']], $selectspeak = [10065], $recipient = '$Attacked', $chance = 50, $comment = 'response - big ship' ],
              ] ],
              table[ $weight = 100, $excludefilter = table[$Attacker=['cantalk', race.xenon]], $comment = 'Attacked by non-talking non-Xenon enemy', $script = [
                table[ $actor = '$Attacked', $selectspeak = [10059, 10077], $recipient = '$Attacker', $comment = 'single-crew ship hit without taking serious damage - silent enemy' ],
              ] ],
              table[ $weight = 100, $filter = table[$Attacker=[race.xenon]], $comment = 'Attacked by Xenon enemy', $script = [
                table[ $actor = '$Attacked', $selectspeak = [10059, 10076, 10077], $recipient = '$Attacker', $comment = 'single-crew ship hit without taking serious damage - xenon' ],
              ] ],
            ]
          ]" />

        <!-- TODO @CBJ/Lorraine: Add generic/silent-enemy variants -->
        <!-- TODO: Actor-specific usecase timeout on $Attacked (30s?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_Normal',
            $priority = 20, $chance = 60, $repeattimeout = 80s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible], $monitor = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $allow_computer = true ],
            ],
            $selectscript = [
              table[ $weight = 100, $filter = table[$Attacker=['cantalk']], $comment = 'Attacked by enemy that can talk (player or NPC with speaker page)', $script = [
                table[ $actor = '$Attacked', $selectspeak = [10062, 10063], $recipient = '$Attacker', $comment = 'small ship hit, not in danger - response-capable' ],
                table[ $actor = '$Attacker', $excludefilter = table[$Attacker=['iscapitalship', class.station]], $selectspeak = [10064], $recipient = '$Attacked', $chance = 50, $comment = 'response - small ship' ],
                table[ $actor = '$Attacker', $filter = table[$Attacker=['iscapitalship']], $selectspeak = [10065], $recipient = '$Attacked', $chance = 50, $comment = 'response - big ship' ],
              ] ],
              table[ $weight = 100, $excludefilter = table[$Attacker=['cantalk']], $comment = 'Attacked by non-talking enemy', $script = [
                table[ $actor = '$Attacked', $selectspeak = [10062, 10063], $recipient = '$Attacker', $comment = 'small ship hit, not in danger - response-capable' ],
              ] ],
            ]
          ]" />

        <!-- TODO: Add optional low-chance response of capital ship captain if player on bridge of attacker -->
        <!-- TODO: Actor-specific usecase timeout on $Attacked (30s?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_Danger',
            $priority = 20, $chance = 100, $repeattimeout = 30s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible], $monitor = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $allow_computer = true ],
            ],
            $script = [
              table[ $actor = '$Attacked', $selectspeak = [10016, 10017, 10018, 10019], $recipient = '$Attacker', $comment = 'small ship hit, in danger, panic' ],
              table[ $actor = '$Attacker', $excludefilter = table[$Attacker=['iscapitalship', class.station]], $selectspeak = [10066, 10067], $recipient = '$Attacked', $chance = 80, $comment = 'response - small ship' ],
            ]
          ]" />

        <!-- TODO: Actor-specific usecase timeout on $Attacked (2min?) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_PleadForLife',
            $priority = 25, $chance = 100, $repeattimeout = 30s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible], $monitor = true ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $passive = true, $optional = true ],
              table[ $name = '$AttackerCaptain', $location = '$AttackerLocation', $allow_duplicate_actor = true, $filter = [controlpost.aipilot, 'iscapitalship', attention.inroom], $optional = true ],
              table[ $name = '$AttackerComms', $location = '$AttackerLocation', $filter = [entityrole.service, controlposition.comms, 'iscapitalship', attention.inroom], $passive = true, $optional = true ],
            ],
            $script = [
              0.2s,
              table[ $actor = '$Attacked', $selectspeak = [10024, 10025, 10028, 10029], $recipient = '$Attacker', $comment = 'single-crew ship hit, life threat' ],
              table[ $actor = '$AttackerCaptain', $templookat = '$AttackerComms', $selectspeak = [10013, 10014], $chance = 15, $comment = 'captain commenting on message (if player is on bridge)' ],
            ]
          ]" />

        <!-- TODO: Not used yet -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_Retaliating',
            $priority = 20, $chance = 100, $repeattimeout = 20s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $passive = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Attacked', $selectspeak = [10015, 10039, 10040], $recipient = '$Attacker', $comment = 'retaliation / joining combat' ],
            ]
          ]" />

        <!-- TODO: Not used yet -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_Fleeing',
            $priority = 20, $chance = 100, $repeattimeout = 20s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $passive = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Attacked', $selectspeak = [10032, 10033], $recipient = '$Attacker', $comment = 'fleeing from combat' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_CallingForHelp',
            $priority = 20, $chance = 100, $repeattimeout = 30s,
            $locations = [ '$AttackedLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
            ],
            $script = [
              table[ $actor = '$Attacked', $selectspeak = [10602], $broadcast = true, $comment = 'Requesting immediate backup!' ],
            ]
          ]" />

        <!-- TODO: Not used yet (currently handled differently in md.Notifications.PlayerOwnedShipAttacks) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Combat_Small_Attacked_Bailing',
            $priority = 20, $chance = 100, $repeattimeout = 15s,
            $locations = [ '$AttackedLocation', '$AttackerLocation' ],
            $actors = [
              table[ $name = '$Attacked', $location = '$AttackedLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Attacker', $location = '$AttackerLocation', $filter = [controlpost.aipilot], $allow_player = true, $allow_computer = true, $passive = true, $optional = true ],
            ],
            $script = [
              table[ $actor = '$Attacked', $selectspeak = [10034], $recipient = '$Attacker', $comment = 'pilot bailing from ship' ],
            ]
          ]" />

        <!-- Station thanking player for destroying tracked hostile and awarding reward -->
        <!-- moved $noconversation and $nofullscreenmenu handling to accumulation (md.Notifications.ReputationTrigger) so we don't queue up multiple notifications if player is in either a conversation or a menu. -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Station_Defended',
            $priority = 15, $speakpriority = 90, $chance = 100, $queue = true, $allow_comm_chatter = false,
            $locations = [ '$StationLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ],
            ],
            $script = [
              table[ $actor = '$StationNPC', $selectspeak = [2110, 2111], $recipient = 'player', $comment = 'grateful',  $speakdelay = 500ms ]
            ]
          ]"/>

        <!-- Station warning player against attacking objects that it is protecting -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Station_Warn_1',
            $priority = 15, $speakpriority = 90, $chance = 100, $noconversation = true, $nofullscreenmenu = true, $allow_comm_chatter = false,
            $locations = [ '$StationLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ]
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7001, $recipient = 'player', $comment = 'first warning - generic',  $speakdelay = 350ms ]
            ]
          ]"/>
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Station_Warn_2',
            $priority = 15, $speakpriority = 90, $chance = 100, $noconversation = true, $nofullscreenmenu = true, $allow_comm_chatter = false,
            $locations = [ '$StationLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ]
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7001, $recipient = 'player', $comment = 'first warning - generic',  $speakdelay = 350ms ],
              table[ $actor = '$StationNPC', $speak = 7002, $recipient = 'player', $comment = 'first warning to an attacking ship' ],
            ]
          ]"/>

        <!-- Station threatening to penalize player hostility -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Station_Retaliate_Warning',
            $priority = 30, $speakpriority = 90, $chance = 100, $noconversation = true, $nofullscreenmenu = true, $allow_comm_chatter = false,
            $locations = [ '$StationLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ],
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7002, $recipient = 'player', $comment = 'first warning against attacking ships',  $speakdelay = 350ms ]
            ]
          ]"/>
        <!-- Station's call for help is acknowledged and help is sent -->
        <!-- player action is offensive to the point that reputation will certainly be penalized. message should not be queued and should be triggered right away. -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Station_Retaliate_Acknowledge',
            $priority = 100, $speakpriority = 99, $chance = 100, $allow_comm_chatter = false,
            $locations = [ '$StationLocation', '$LawNPCLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ],
              table[ $name = '$LawNPC', $location = '$LawNPCLocation', $monitor = table[ $forceonplayer = true ] ]
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7002, $recipient = 'player', $comment = 'first warning against attacking ships',  $speakdelay = 350ms ],
              table[ $actor = '$StationNPC', $speak = 7003, $recipient = 'player', $comment = 'warning of consequences - generic' ],
              table[ $actor = '$LawNPC', $speak = 11201, $recipient = '$StationNPC', $comment = 'law enforcement response to comms',  $speakdelay = 450ms ],
              table[ $actor = '$LawNPC', $speak = 2005, $recipient = '$StationNPC', $comment = 'Greeting - over comms' ],
              table[ $actor = '$StationNPC', $speak = 7008, $recipient = '$LawNPC', $comment = 'report of attack - stations' ],
              table[ $actor = '$LawNPC', $selectspeak = [2103,2104,2105], $recipient = '$StationNPC', $comment = 'formal acknowledgement',  $speakdelay = 150ms ],
              table[ $actor = '$LawNPC', $speak = 7009, $recipient = '$StationNPC', $comment = 'law enforcement confirms report' ],
            ]
          ]"/>
        <!-- Station's call for help is refused due to attacked object being wanted by police faction -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Station_Retaliate_Refuse',
            $priority = 30, $speakpriority = 90, $chance = 100, $noconversation = true, $nofullscreenmenu = true, $allow_comm_chatter = false,
            $locations = [ '$StationLocation', '$LawNPCLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ],
              table[ $name = '$LawNPC', $location = '$LawNPCLocation', $monitor = table[ $forceonplayer = true ] ]
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7002, $recipient = 'player', $comment = 'first warning against attacking ships',  $speakdelay = 350ms ],
              table[ $actor = '$StationNPC', $speak = 3020, $recipient = 'player', $comment = 'Security forces.' ],
              table[ $actor = '$LawNPC', $speak = 11201, $recipient = '$StationNPC', $comment = 'law enforcement response to comms',  $speakdelay = 450ms ],
              table[ $actor = '$LawNPC', $speak = 2005, $recipient = '$StationNPC', $comment = 'Greeting - over comms' ],
              table[ $actor = '$StationNPC', $speak = 7008, $recipient = '$LawNPC', $comment = 'report of attack - stations',  $speakdelay = 150ms ],
              table[ $actor = '$LawNPC', $speak = 2109, $recipient = '$StationNPC', $comment = 'rejection' ]
            ]
          ]"/>

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Ship_Retaliate_Acknowledge',
            $priority = 100, $speakpriority = 99, $chance = 100, $allow_comm_chatter = false,
            $locations = [ '$StationLocation', '$LawNPCLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ],
              table[ $name = '$LawNPC', $location = '$LawNPCLocation', $monitor = table[ $forceonplayer = true ] ]
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7002, $recipient = 'player', $comment = 'first warning against attacking ships',  $speakdelay = 350ms ],
              table[ $actor = '$StationNPC', $speak = 7003, $recipient = 'player', $comment = 'warning of consequences - generic' ],
              table[ $actor = '$LawNPC', $speak = 11201, $recipient = '$StationNPC', $comment = 'law enforcement response to comms',  $speakdelay = 450ms ],
              table[ $actor = '$LawNPC', $speak = 2005, $recipient = '$StationNPC', $comment = 'Greeting - over comms' ],
              table[ $actor = '$StationNPC', $speak = 7010, $recipient = '$LawNPC', $comment = 'report of attack - stations' ],
              table[ $actor = '$LawNPC', $selectspeak = [2103,2104,2105], $recipient = '$StationNPC', $comment = 'formal acknowledgement',  $speakdelay = 150ms ],
              table[ $actor = '$LawNPC', $speak = 7009, $recipient = '$StationNPC', $comment = 'law enforcement confirms report' ],
            ]
          ]"/>
        <!-- Station's call for help is refused due to attacked object being wanted by police faction -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$IllegalActivity_Ship_Retaliate_Refuse',
            $priority = 30, $speakpriority = 90, $chance = 100, $noconversation = true, $nofullscreenmenu = true, $allow_comm_chatter = false,
            $locations = [ '$StationLocation', '$LawNPCLocation' ],
            $actors = [
              table[ $name = '$StationNPC', $location = '$StationLocation', $filter = [controlpost.manager], $monitor = table[ $forceonplayer = true ] ],
              table[ $name = '$LawNPC', $location = '$LawNPCLocation', $monitor = table[ $forceonplayer = true ] ]
            ],
            $script = [
              table[ $actor = '$StationNPC', $speak = 7002, $recipient = 'player', $comment = 'first warning against attacking ships',  $speakdelay = 350ms ],
              table[ $actor = '$StationNPC', $speak = 3020, $recipient = 'player', $comment = 'Security forces.' ],
              table[ $actor = '$LawNPC', $speak = 11201, $recipient = '$StationNPC', $comment = 'law enforcement response to comms',  $speakdelay = 450ms ],
              table[ $actor = '$LawNPC', $speak = 2005, $recipient = '$StationNPC', $comment = 'Greeting - over comms' ],
              table[ $actor = '$StationNPC', $speak = 7010, $recipient = '$LawNPC', $comment = 'report of attack - stations',  $speakdelay = 150ms ],
              table[ $actor = '$LawNPC', $speak = 2109, $recipient = '$StationNPC', $comment = 'rejection' ]
            ]
          ]"/>

        <!-- ***** Inspection ***** -->

        <!-- Chatter after interactive event and response by player -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_AfterPlayerEvent_Comply',
            $priority = 50, $chance = 100, $repeattimeout = 15s,
            $locations = [ '$InspectorLocation', '$InspectedLocation', '$PirateLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
              table[ $name = '$Pirate', $location = '$PirateLocation', $optional = true ],
            ],
            $script = [
              0.4s,
              table[ $actor = '$Inspector', $speak = 9006, $recipient = '$Inspected', $filter = table[$Pirate=true], $comment = '(ship complies to pirate instructions)' ],
              table[ $actor = '$Inspector', $speak = 8001, $recipient = '$Inspected', $excludefilter = table[$Pirate=true], $comment = '(ship complies to police instructions)' ],
            ]
          ]" />

        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_AfterPlayerEvent_Refuse',
            $priority = 50, $chance = 100, $repeattimeout = 15s,
            $locations = [ '$InspectorLocation', '$InspectedLocation', '$PirateLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
              table[ $name = '$Pirate', $location = '$PirateLocation', $optional = true ],
            ],
            $script = [
              0.4s,
              table[ $actor = '$Inspector', $selectspeak = [9004,9005], $recipient = '$Inspected', $filter = table[$Pirate=true], $comment = '(criminal cursing)' ],
              table[ $actor = '$Inspector', $speak = 10015, $recipient = '$Inspected', $filter = table[$Pirate=true], $chance = 85, $comment = '(retaliate)' ],
              table[ $actor = '$Inspector', $speak = 8002, $recipient = '$Inspected', $excludefilter = table[$Pirate=true], $comment = '(ship does not comply)' ],
            ]
          ]" />

        <!-- Chatter cases when player is not involved -->
        <!-- Inspection by police, ship complies, nothing found -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_Police_Comply_Legal',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$InspectorLocation', '$InspectedLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Inspector', $speak = 11202, $recipient = '$Inspected', $comment = '(ship scan warning - cargo)' ],
              table[ $select = [
                table[ $weight = 1.5, $actor = '$Inspected', $speak = 11207, $recipient = '$Inspector', $comment = '(ship scanned by police - compliant)' ],
                0.7s,
              ] ],
              table[ $actor = '$Inspector', $speak = 11204, $recipient = '$Inspected', $comment = '(ship scan result - nothing found)' ],
              table[ $actor = '$Inspected', $speak = 11208, $recipient = '$Inspector', $chance = 30, $comment = '(ship scanned by police - nothing found)' ],
            ]
          ]" />

        <!-- Inspection by police, ship complies, illegal cargo found -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_Police_Comply_Illegal',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$InspectorLocation', '$InspectedLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Inspector', $speak = 11202, $recipient = '$Inspected', $comment = '(ship scan warning - cargo)' ],
              table[ $select = [
                table[ $weight = 0.25, $actor = '$Inspected', $speak = 11207, $recipient = '$Inspector', $comment = '(ship scanned by police - compliant)' ],
                0.7s,
              ] ],
              table[ $actor = '$Inspector', $speak = 11205, $recipient = '$Inspected', $comment = '(ship scan result - something found)' ],
              table[ $actor = '$Inspected', $speak = 11209, $recipient = '$Inspector', $chance = 15, $comment = '(ship scanned by police - something found)' ],
              table[ $actor = '$Inspector', $speak = 11206, $recipient = '$Inspected', $comment = '(ordering to drop cargo/contraband)' ],
              0.5s,
              table[ $actor = '$Inspected', $selectspeak = [6009, 2108],  $recipient = '$Inspector', $chance = 80, $comment = 'Releasing cargo now. -or- Okay.' ],
              0.3s,
              table[ $actor = '$Inspector', $speak = 8001, $recipient = '$Inspected', $chance = 30, $comment = '(ship complies to police instructions)' ],
            ]
          ]" />

        <!-- Inspection by police, ship does not comply -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_Police_Refuse',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$InspectorLocation', '$InspectedLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Inspector', $speak = 11202, $recipient = '$Inspected', $comment = '(ship scan warning - cargo)' ],
              table[ $select = [
                table[ $weight = 1.5, $actor = '$Inspected', $speak = 5016, $recipient = '$Inspector', $comment = '(refusal to do something)' ],
                0.7s,
              ] ],
              table[ $actor = '$Inspector', $speak = 8002, $recipient = '$Inspected', $chance = 30, $comment = '(ship does not comply)' ],
              table[ $actor = '$Inspected', $selectspeak = [9004,9005], $recipient = '$Inspector', $filter = table[$Inspected=[faction.criminal]], $chance = 30, $comment = '(criminal cursing)' ],
            ]
          ]" />

        <!-- Pirate harassment, ship complies -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_Pirate_Comply',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$InspectorLocation', '$InspectedLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Inspector', $speak = 11301, $recipient = '$Inspected', $chance = 20, $comment = '(ship scan warning, pirate case)' ],
              table[ $actor = '$Inspector', $speak = 11310, $recipient = '$Inspected', $comment = '(pirate requesting to drop cargo)' ],
              table[ $actor = '$Inspected', $speak = 11401, $recipient = '$Inspector', $comment = '(ordered to drop cargo - releases under duress)' ],
              0.4s,
              table[ $actor = '$Inspector', $speak = 9006, $recipient = '$Inspected', $chance = 50, $comment = '(ship complies to pirate instructions)' ],
            ]
          ]" />

        <!-- Pirate harassment, ship does not comply -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$InspectCargo_Pirate_Refuse',
            $priority = 30, $chance = 100, $repeattimeout = 1min,
            $locations = [ '$InspectorLocation', '$InspectedLocation' ],
            $actors = [
              table[ $name = '$Inspector', $location = '$InspectorLocation', $filter = [controlpost.aipilot, attention.visible] ],
              table[ $name = '$Inspected', $location = '$InspectedLocation', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Inspector', $speak = 11301, $recipient = '$Inspected', $chance = 20, $comment = '(ship scan warning, pirate case)' ],
              table[ $actor = '$Inspector', $speak = 11310, $recipient = '$Inspected', $comment = '(pirate requesting to drop cargo)' ],
              table[ $actor = '$Inspected', $speak = 5016, $recipient = '$Inspector', $comment = '(refusal to do something)' ],
              table[ $actor = '$Inspector', $selectspeak = [9004,9005], $recipient = '$Inspected', $comment = '(criminal cursing)' ],
              table[ $actor = '$Inspector', $speak = 10015, $recipient = '$Inspected', $chance = 85, $comment = '(retaliate)' ],
            ]
          ]" />

        <!-- Usecases for Scenario_combat -->
        <!-- Accelerator entry -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_accelerator_entry',
            $priority = 100, $speakpriority = 100, $chance = 100, $voiceover = true,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Helm', $location = '$Bridge', $filter = [controlposition.flight] ],
            ],
            $script = [
              table[ $actor = '$Helm', $speak = 10414, $templookat = '$Captain', $comment = 'Approaching accelerator.' ],
              table[ $actor = '$Captain', $speak = 30401001, $templookat = '$Helm', $comment = 'Take us through.' ],
            ]
          ]" />

        <!-- Accelerator exit -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_accelerator_exit',
            $priority = 100, $speakpriority = 100, $chance = 100, $voiceover = true,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Helm', $location = '$Bridge', $filter = [controlposition.flight] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 30401002, $templookat = '$Helm', $comment = 'Once we clear the accelerator set a course for the shipyard.' ],
              table[ $actor = '$Helm', $speak = 2105, $templookat = '$Captain', $comment = 'Acknowledged.' ],
              table[ $actor = '$Captain', $speak = 30401019, $templookat = 'player', $comment = 'Pilot, head to the bridge. We need you on standby.' ],
            ]
          ]" />

        <!-- Player arrives on bridge -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_player_arrives_on_bridge',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Marine', $location = '$Bridge', $filter = [entityrole.marine] ],
            ],
            $script = [
              table[ $actor = '$Marine', $speak = 3001, $templookat = 'player', $comment = 'Sir.' ],
              0.5s,
              table[ $actor = '$Captain', $speak = 30401003, $templookat = 'player', $comment = 'Ah, pilot. Good timing.' ],
            ]
          ]" />

        <!-- Enemy miner spotted -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_miner_spotted',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401001, $templookat = '$Captain', $comment = 'Xenon miner spotted.' ],
              table[ $actor = '$Captain', $speak = 30401004, $templookat = '$Gunner', $comment = 'Good. Our first catch of the day.' ],
              table[ $actor = '$Captain', $speak = 30401005, $templookat = '$Gunner', $comment = 'Move to intercept.' ],
              table[ $actor = '$Captain', $speak = 30401006, $templookat = 'player', $comment = 'You better get down there, pilot.' ],
            ]
          ]" />

        <!-- Player ordered to undock -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_elevator_reminder',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 30401007, $templookat = 'player', $comment = 'Use the evelator to get to the dockingbay.' ],
            ]
          ]" />

        <!-- Player sat down in fighter -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_undock_prep',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 10804, $templookat = 'player', $comment = 'Prepare undocking procedures.' ],
            ]
          ]" />

        <!-- Player sat down in fighter -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_undock_ready',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 10807, $templookat = 'player', $comment = 'Cleared for undocking.' ],
            ]
          ]" />

        <!-- Player reminded to undock -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_undock_reminder',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 30401008, $templookat = 'player', $comment = 'Pilot, your ship is ready to go.' ],
            ]
          ]" />

        <!-- Player has undocked -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_player_undocked',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Helm', $location = '$Bridge', $filter = [controlposition.flight] ],
            ],
            $script = [
              table[ $actor = '$Helm', $speak = 10811, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'Docking position cleared.' ],
              table[ $actor = '$Captain', $speak = 10509, $templookat = 'player', $comment = 'You are free to engage.' ],
            ]
          ]" />

        <!-- Player was teleported out of the destroyed ship -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_player_emergency_teleport',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Computer', $location = '$Bridge', $allow_computer = true ],
            ],
            $script = [
              table[ $actor = '$Computer', $speak = 1017, $templookat = 'player', $comment = 'Emergency teleport successful.' ],
              0.5s,
              table[ $actor = '$Captain', $speak = 30401023, $templookat = 'player', $comment = 'Your reserve fighter is waiting for you at the docking bay.' ],
              table[ $actor = '$Captain', $speak = 30401024, $templookat = 'player', $comment = 'Take care, it`s our last one!' ],
            ]
          ]" />

        <!-- Miner is destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_miner_destroyed',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 10061, $allow_comm_chatter = true, $comment = 'Target destroyed!' ],
              table[ $actor = '$Captain', $speak = 30401009, $allow_comm_chatter = true, $comment = 'Resume course and keep an eye on sensors.' ],
            ]
          ]" />

        <!-- Enemy squad approaches -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_squad_spotted',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401002, $allow_comm_chatter = true, $comment = 'Wing of Xenon coming in.' ],
              table[ $actor = '$Captain', $speak = 30401010, $templookat = 'player', $comment = 'They`re trying to slow us down.' ],
              table[ $actor = '$Captain', $speak = 30401011, $templookat = 'player', $comment = 'Prepare to engage.' ],
            ]
          ]" />

        <!-- Player kills enemy fighter -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_player_killed_fighter',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401003, $templookat = 'player', $comment = 'That`s one down. Good shooting!' ],
            ]
          ]" />

        <!-- Enemy squad is almost destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_enemy_squad_almost_destroyed',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401012, $templookat = 'player', $comment = 'Keep it up, only a few left.' ],
            ]
          ]" />

        <!-- Enemy squad is destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_enemy_squad_destroyed',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401004, $broadcast = true, $comment = 'That`s the last of them.' ],
              table[ $actor = '$Captain', $speak = 10038, $broadcast = true, $comment = 'Well done, everyone!' ],
            ]
          ]" />

        <!-- Station calls for help -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_station_calls_for_help',
            $priority = 100, $speakpriority = 100, $chance = 100, $voiceover = true,
            $locations = [ '$Bridge', '$Station' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Helm', $location = '$Bridge', $filter = [controlposition.flight] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
              table[ $name = '$Manager', $location = '$Station', $filter = [controlpost.manager] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401005, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'The shipyard is hailing us. Putting it through.' ],
              table[ $actor = '$Manager', $speak = 10001, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'Enemy spotted.' ],
              table[ $actor = '$Manager', $speak = 10602, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'Requesting immediate backup!' ],
              table[ $actor = '$Captain', $speak = 10609, $templookat = '$Manager', $allow_comm_chatter = true, $comment = 'We`ve received your call. We`re on the way.' ],
              table[ $actor = '$Captain', $speak = 3105, $allow_comm_chatter = true, $comment = 'Helm!' ],
              table[ $actor = '$Helm', $speak = 5006, $allow_comm_chatter = true, $comment = 'Activating travel drive.' ],
            ]
          ]" />

        <!-- Station calls for help -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_travel_drive',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge', '$Station' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 30401013, $templookat = 'player', $comment = 'Pilot, activate your travel drive if you want to keep up.' ],
            ]
          ]" />

        <!-- Allied destroyer approaches station -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_destroyer_approaches_station',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 30401014, $templookat = 'player', $comment = 'We can`t afford to lose that station.' ],
              table[ $actor = '$Gunner', $speak = 30401006, $templookat = 'player', $comment = 'A capship is finishing construction and preparing to launch.' ],
              table[ $actor = '$Captain', $speak = 30401015, $templookat = 'player', $comment = 'All the more reason. Give them hell!' ],
            ]
          ]" />

        <!-- Player approaches station -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_player_approaches_station',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 30401016, $templookat = 'player', $comment = 'See if you can take out their turrets.' ],
            ]
          ]" />

        <!-- Enemy turrets are destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_turrets_destroyed',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot], $passive = true ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401007, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'Their turrets are down.' ],
            ]
          ]" />

        <!-- Allied bombers attack -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_bombers_attack',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Cockpit' ],
            $actors = [
              table[ $name = '$Pilot', $location = '$Cockpit', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Pilot', $speak = 10082, $allow_comm_chatter = true, $comment = 'Let`s see how they handle a torpedo.' ],
            ]
          ]" />

        <!-- Enemy drones launch -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_drones_launch',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 10085, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'Drones launching!' ],
              table[ $actor = '$Captain', $speak = 30401020, $templookat = 'player', $comment = 'They`re targeting the bombers! Pilot, protect them!' ],
            ]
          ]" />

        <!-- Enemy drones are destroyed, attack engines -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_drones_destroyed_attack_engines',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401009, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'That`s the last of the drones, the bombers are safe.' ],
              table[ $actor = '$Captain', $speak = 30401025, $templookat = 'player', $comment = 'Make sure they don`t try to run. Pilot, target their engines!' ],
            ]
          ]" />

        <!-- Enemy drones are destroyed, engines are already gone -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_drones_destroyed_finish_destroyer',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401009, $templookat = '$Captain', $allow_comm_chatter = true, $comment = 'That`s the last of the drones, the bombers are safe.' ],
              table[ $actor = '$Captain', $speak = 30401022, $templookat = 'player', $comment = 'Pilot, assist the bombers in finishing off the enemy.' ],
            ]
          ]" />

        <!-- Enemy destroyer's engines are destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_destroyer_engines_destroyed',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 30401008, $templookat = 'player', $comment = 'Target disabled.' ],
              table[ $actor = '$Captain', $speak = 30401022, $templookat = 'player', $comment = 'Pilot, assist the bombers in finishing off the enemy.' ],
            ]
          ]" />

        <!-- Enemy destroyer is destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_enemy_destroyer_destroyed',
            $priority = 100, $speakpriority = 100, $chance = 100, $voiceover = true,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
              table[ $name = '$Gunner', $location = '$Bridge', $filter = [controlposition.gunner] ],
            ],
            $script = [
              table[ $actor = '$Gunner', $speak = 10051, $templookat = 'player', $comment = 'It`s going to blow!' ],
              table[ $actor = '$Captain', $speak = 30401017, $templookat = 'player', $comment = 'Clear the area!' ],
            ]
          ]" />

        <!-- Enemy destroyer is destroyed -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Scenario_combat_aftermath',
            $priority = 100, $speakpriority = 100, $chance = 100,
            $locations = [ '$Bridge' ],
            $actors = [
              table[ $name = '$Captain', $location = '$Bridge', $filter = [controlpost.aipilot] ],
            ],
            $script = [
              table[ $actor = '$Captain', $speak = 12208, $templookat = 'player', $comment = 'Good work everyone.' ],
              table[ $actor = '$Captain', $speak = 30401018, $templookat = 'player', $comment = 'Comms, ask the station if they require assistance.' ],
            ]
          ]" />

        <!--*** Story_Diplomacy_Intro ***-->

        <!-- Reen introduction 1 -->
        <!--TODO - look at without speak?-->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Meet_Reen_1',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Reen', $location = '$Office' ],
              table[ $name = '$Crewman', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Crewman', $speak = 10905, $recipient = '$Reen', $comment = 'The trade deal has been confirmed' ],
              1s,
              table[ $actor = '$Reen', $templookat = '$Crewman', $speak = 30202001, $recipient = '$Crewman', $comment = 'That will be all.' ],
            ]
          ]" />

        <!-- Reen introduction 2 -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Meet_Reen_2',
            $priority = 100, $chance = 100,
            $locations = [ '$Office', '$Dal_Room' ],
            $actors = [
              table[ $name = '$Reen', $location = '$Office' ],
              table[ $name = '$Dal', $location = '$Dal_Room' ],
            ],
            $script = [
              1.5s,
              table[ $actor = '$Reen', $lookat = 'player', $speak = 30202002, $recipient = 'player', $comment = 'Please come in.' ],
              table[ $actor = '$Reen', $speak = 30202003, $recipient = 'player' ],
              table[ $actor = '$Reen', $templookat = 'player', $speak = 30202004, $recipient = 'player' ],
              0.2s,
              table[ $actor = '$Dal', $speak = 30202001, $recipient = '$Reen', $broadcast = true ],
              0.2s,
              table[ $actor = '$Reen', $speak = 30202005, $recipient = 'player' ],
              table[ $actor = '$Reen', $lookat = 'player', $speak = 30202006, $recipient = 'player' ],
              table[ $actor = '$Reen', $speak = if true then 30202008 else 30202007, $recipient = 'player', $comment = 'We have prepared a freighter for you' ],
              1s,
              table[ $actor = '$Reen', $speak = if true then 30202010 else 30202009, $recipient = 'player' ],
              table[ $actor = '$Reen', $speak = if true then 30202012 else 30202011, $recipient = 'player' ],
              1s,
              table[ $actor = '$Reen', $speak = if true then 30202014 else 30202013, $recipient = 'player' ],
              table[ $actor = '$Reen', $lookat = 'player', $speak = 30202015, $recipient = 'player' ],
              table[ $actor = '$Reen', $speak = if true then 30202017 else 30202016, $recipient = 'player' ],
            ]
          ]" />

        <!-- Eavesdrop scene 1 -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Dal_Eavesdrop_1',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Office' ],
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Dal',   $speak = 30202002, $recipient = '$Reen' ],
              table[ $actor = '$Reen',  $speak = 30202018, $recipient = '$Dal' ,    $templookat = '$Dal'],
              table[ $actor = '$Dal',   $speak = 30202003, $recipient = '$Reen', $templookat = '$Reen' ],
              table[ $actor = '$Reen',  $speak = 30202019, $recipient = '$Dal' ],
            ]
          ]" />

        <!-- Eavesdrop scene 2 -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Dal_Eavesdrop_2',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Office' ],
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $speak = 30202020,  $recipient = '$Dal', $templookat = '$Dal' ],
              table[ $actor = '$Dal',   $speak = 30202004,  $recipient = '$Reen' ],
              table[ $actor = '$Reen',  $speak = 30202021,  $recipient = '$Dal' ],
              table[ $actor = '$Dal',   $speak = 30202005,  $recipient = '$Reen' ],
              table[ $actor = '$Dal',   $speak = 30202006,  $recipient = '$Reen' ],
              table[ $actor = '$Reen',  $speak = 30202022,  $recipient = '$Dal' ],
            ]
          ]" />

        <!-- Eavesdrop scene 3 -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Dal_Eavesdrop_3',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Office' ],
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $speak = 30202023,  $recipient = '$Dal' ],
              table[ $actor = '$Dal',   $speak = 30202007,  $recipient = '$Reen' ],
            ]
          ]" />

        <!-- Meet Dal scene 1 -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Meet_Dal_1',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Office' ],
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $speak = if true then 30202088 else 30202087,  $recipient = 'player' ],
              table[ $actor = '$Dal',   $speak = 30202008,  $recipient = 'player' ],
            ]
          ]" />

        <!-- Meet Dal scene 2a (had police trouble) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Meet_Dal_2a',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $speak = if true then 30202025 else 30202024,  $recipient = 'player' ],
              table[ $actor = '$Reen',  $speak = 30202026,  $recipient = 'player' ],
            ]
          ]" />

        <!-- Meet Dal scene 2b (no police trouble) -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Meet_Dal_2b',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $speak = 30202027,  $recipient = 'player' ],
            ]
          ]" />

        <!-- Meet Dal scene 3  -->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Meet_Dal_3',
            $priority = 100, $chance = 100,
            $locations = [ '$Office' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Office' ],
              table[ $name = '$Reen', $location = '$Office' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $speak = 30202028,  $recipient = 'player', $templookat = '$Dal' ],
              table[ $actor = '$Dal',   $speak = 30202009,  $recipient = 'player' ],
              table[ $actor = '$Reen',  $speak = 30202029,  $recipient = 'player' ],
              table[ $actor = '$Reen',  $speak = 30202030,  $recipient = 'player' ],
              table[ $actor = '$Dal',   $speak = 30202010,  $recipient = 'player', $templookat = '$Reen' ],
              table[ $actor = '$Reen',  $speak = 30202031,  $recipient = 'player', $templookat = '$Dal' ],
              table[ $actor = '$Reen',  $speak = if true then 30202033 else 30202032,  $recipient = 'player' ],
              table[ $actor = '$Reen',  $speak = 30202034,  $recipient = 'player' ],
              table[ $actor = '$Dal',   $speak = 30202011,  $recipient = 'player' ],
              0.5s,
              table[ $actor = '$Dal',   $speak = if true then 30202013 else 30202012,  $recipient = 'player' ],
              4.5s,
              table[ $actor = '$Reen',  $speak = 30202035,  $recipient = 'player' ],
              5s,
            ]
          ]" />

        <!--Diplomatic intro mission part 3-->

        <!--Harass Scale Plate Comm-->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Harass_ScalePlate_Comm',
            $priority = 100, $chance = 100,
            $locations = [ '$Station' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Station' ],
              table[ $name = '$Reen', $location = '$Station' ],
            ],
            $script = [
              table[ $actor = '$Reen',  $recipient = 'player',  $speak = 30202052 ],
              table[ $actor = '$Reen',  $recipient = 'player',  $speak = 30202053 ],
              table[ $actor = '$Reen',  $recipient = 'player',  $speak = 30202054 ],
              table[ $actor = '$Dal',   $recipient = 'player',  $speak_to_male = 30202057, $speak_to_female = 30202058 ],
              table[ $actor = '$Dal',   $recipient = 'player',  $speak = 30202059 ],
              table[ $actor = '$Reen',  $recipient = 'player',  $speak = 30202055 ],
              2.5s,
              table[ $actor = '$Dal',   $recipient = 'player',  $speak = 30202061 ],
              table[ $actor = '$Dal',   $recipient = 'player',  $speak = 30202062 ],
            ]
          ]" />

        <!--Diplomatic intro mission part 4-->

        <!--Target ship heading to player-->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Follow_Ship_Intro',
            $priority = 100, $chance = 100,
            $locations = [ '$DalShip' ],
            $actors = [
              table[ $name = '$Dal', $location = '$DalShip' ],
              table[ $name = '$Cline', $location = '$DalShip' ],
            ],
            $script = [
              table[ $actor = '$Dal',   $recipient = 'player',  $speak_to_male = 30202092, $speak_to_female = 30202093 ],
              table[ $actor = '$Cline', $recipient = 'player',  $speak = 30202052 ],
              table[ $actor = '$Dal',   $recipient = 'player',  $speak = 30202083 ],
              0.5s,
              table[ $actor = '$Dal',   $recipient = 'player',  $speak_to_male = 30202094, $speak_to_female = 30202095 ],
              0.5s,
              table[ $actor = '$Dal',   $recipient = 'player',  $speak_to_male = 30202096, $speak_to_female = 30202097 ],
              table[ $actor = '$Dal',   $recipient = 'player',  $speak_to_male = 30202098, $speak_to_female = 30202099 ],
            ]
          ]" />

        <!--Police Encounter-->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_Follow_Ship_Police_Encounter',
            $priority = 100, $chance = 100,
            $locations = [ '$DalShip', '$FollowedShip', '$PoliceShip' ],
            $actors = [
              table[ $name = '$Dal', $location = '$DalShip' ],
              table[ $name = '$Teladi', $location = '$FollowedShip' ],
              table[ $name = '$Police', $location = '$PoliceShip' ],
            ],
            $script = [
              table[ $actor = '$Police', $recipient = '$Teladi',  $speak = 30202008 ],
              1s,
              table[ $actor = '$Teladi', $recipient = '$Police',  $speak = 30202001 ],
              table[ $actor = '$Police', $recipient = '$Teladi',  $speak = 30202009 ],
              0.5s,
              table[ $actor = '$Dal',    $recipient = 'player',   $speak = 30202116 ],
              table[ $actor = '$Police', $recipient = '$Teladi',  $speak = 30202010 ],
              table[ $actor = '$Teladi', $recipient = '$Police',  $speak = 30202002 ],
              table[ $actor = '$Teladi', $recipient = '$Police',  $speak = 30202003 ],
              0.3s,
              table[ $actor = '$Dal',    $recipient = 'player',   $speak = 30202117 ],
              0.3s,
              table[ $actor = '$Police', $recipient = '$Teladi',  $speak = 30202011 ],
              table[ $actor = '$Teladi', $recipient = '$Police',  $speak = 30202004 ],
              2s,
              table[ $actor = '$Dal',    $recipient = 'player',   $speak = 30202118 ],
              1s,
              table[ $actor = '$Dal',    $recipient = 'player',   $speak_to_male = 30202119, $speak_to_female = 30202120 ],
            ]
          ]" />

        <!--Diplomatic intro mission part 5-->

        <!--Scale Plate meeting-->
        <signal_cue_instantly cue="AddUseCaseDef" param="table[ $name = '$Diplomacy_Intro_ScalePlate_Meeting',
            $priority = 100, $chance = 100, $voiceover = true,
            $locations = [ '$Station' ],
            $actors = [
              table[ $name = '$Dal', $location = '$Station' ],
              table[ $name = '$Teladi', $location = '$Station' ],
            ],
            $script = [
              table[ $actor = '$Teladi',  $recipient = '$Dal',    $speak = 30202002 ],
              table[ $actor = '$Dal',     $recipient = '$Teladi', $speak = 30202182 ],
              table[ $actor = '$Teladi',  $recipient = '$Dal',    $speak = 30202003 ],
              table[ $actor = '$Teladi',  $recipient = '$Dal',    $speak = 30202004 ],
              table[ $actor = '$Dal',     $recipient = '$Teladi', $speak = 30202183 ],
              table[ $actor = '$Dal',     $recipient = 'player',  $speak = 30202228, $templookat = 'player' ],
            ]
          ]" />

      </actions>
    </library>

  </cues>
</mdscript>
