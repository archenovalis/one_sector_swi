<?xml version="1.0" encoding="utf-8"?>
<diff xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="../../../../../getting_a_job/xsd/mddiff.xsd">
	<replace sel="/mdscript">
		<mdscript name="SW_planetaryaid" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="D:\x4 extract\libraries\md.xsd">
			<cues>
				<cue name="Init" mapeditor="false">
					<actions>
						<do_if value="not $FillStationGroup?">
							<!-- when adding future planetary tradestations, set min hull to 1 and add to group -->
							<create_group groupname="$FillStationGroup" />
							<set_value name="$PlanetaryWares" exact="table[]" />
							<set_value name="$PlanetaryWares.{ware.advancedcomposites}" exact="25" />
							<set_value name="$PlanetaryWares.{ware.advancedelectronics}" exact="14" />
							<set_value name="$PlanetaryWares.{ware.antimattercells}" exact="50" />
							<set_value name="$PlanetaryWares.{ware.antimatterconverters}" exact="80" />
							<set_value name="$PlanetaryWares.{ware.claytronics}" exact="66" />
							<set_value name="$PlanetaryWares.{ware.dronecomponents}" exact="16" />
							<set_value name="$PlanetaryWares.{ware.energycells}" exact="525" />
							<set_value name="$PlanetaryWares.{ware.engineparts}" exact="42" />
							<set_value name="$PlanetaryWares.{ware.fieldcoils}" exact="53" />
							<set_value name="$PlanetaryWares.{ware.foodrations}" exact="345" />
							<set_value name="$PlanetaryWares.{ware.graphene}" exact="45" />
							<set_value name="$PlanetaryWares.{ware.hullparts}" exact="59" />
							<set_value name="$PlanetaryWares.{ware.meat}" exact="116" />
							<set_value name="$PlanetaryWares.{ware.medicalsupplies}" exact="125" />
							<set_value name="$PlanetaryWares.{ware.microchips}" exact="22" />
							<set_value name="$PlanetaryWares.{ware.missilecomponents}" exact="57" />
							<set_value name="$PlanetaryWares.{ware.plasmaconductors}" exact="9" />
							<set_value name="$PlanetaryWares.{ware.quantumtubes}" exact="24" />
							<set_value name="$PlanetaryWares.{ware.refinedmetals}" exact="60" />
							<set_value name="$PlanetaryWares.{ware.rhydoniumcell}" exact="1" />
							<set_value name="$PlanetaryWares.{ware.scanningarrays}" exact="11" />
							<set_value name="$PlanetaryWares.{ware.shieldcomponents}" exact="29" />
							<set_value name="$PlanetaryWares.{ware.shipsupplies}" exact="6" />
							<set_value name="$PlanetaryWares.{ware.siliconwafers}" exact="50" />
							<set_value name="$PlanetaryWares.{ware.smartchips}" exact="43" />
							<set_value name="$PlanetaryWares.{ware.spices}" exact="150" />
							<set_value name="$PlanetaryWares.{ware.superfluidcoolant}" exact="55" />
							<set_value name="$PlanetaryWares.{ware.turretcomponents}" exact="14" />
							<set_value name="$PlanetaryWares.{ware.water}" exact="145" />
							<set_value name="$PlanetaryWares.{ware.weaponcomponents}" exact="17" />
							<set_value name="$PlanetaryWares.{ware.wheat}" exact="186" />
						</do_if>
						<set_value name="$_SingleLog_1" exact="0" />
					</actions>
					<cues>

						<!-- param=table[$Station = (new station), $Prefill = (bool: fill with 120 cycles of resources) -->
						<cue name="AddStation" instantiate="true">
							<conditions>
								<event_cue_signalled />
							</conditions>
							<actions>
								<set_value name="$Station" exact="event.param.$Station" />
								<add_to_group groupname="$FillStationGroup" object="$Station" />
								<set_object_min_hull object="$Station" exact="1" />
								<do_if value="@event.param.$Prefill">
									<do_for_each name="$ware" in="$PlanetaryWares">
										<debug_text text="workforce" />
										<set_value name="$waresAmount" exact="$Station.cargo.{$ware}.count" />
										<do_if value="$waresAmount == 0">
											<set_value name="$wareNum" exact="$PlanetaryWares.{$ware}" />
											<add_cargo object="$Station" ware="$ware" exact="$wareNum*120" />
										</do_if>
									</do_for_each>
								</do_if>
							</actions>
						</cue>

						<cue name="ProcessWaresLoop" instantiate="true" checkinterval="61" checktime="player.age + 90s">
							<actions>
								<do_if value="$_SingleLog_1 == 0">
									<find_station groupname="$FillStationGroup" multiple="true" space="player.galaxy" tradestation="true" functional="true">
										<match owner="faction.civilian" />
									</find_station>
								</do_if>
								<set_value name="$delayalpha" exact="0s" />
								<do_if value="$FillStationGroup.count gt 0">
									<do_all exact="$FillStationGroup.count" counter="$i">
										<set_value name="$Station" exact="$FillStationGroup.{$i}" />
										<set_value name="$delayalpha" exact="($delayalpha + 1.0)s" />
										<include_actions ref="ProcessWares" />
									</do_all>
									<do_if value="$_SingleLog_1 == 0">
										<set_value name="$_SingleLog_1" exact="1" />
									</do_if>
								</do_if>
							</actions>
						</cue>
						<library name="ProcessWares">
							<delay exact="$delayalpha" />
							<actions>
								<do_if value="$Station.exists">
									<set_object_min_hull object="$Station" exact="1" />
									<do_for_each name="$ware" in="$PlanetaryWares">
										<set_value name="$wareNum" exact="$PlanetaryWares.{$ware}" />
										<set_value name="$waresAmount" exact="$Station.cargo.{$ware}.count" />
										<set_value name="$maxWaresAmount" exact="$Station.cargo.{$ware}.target" />
										<set_value name="$addWaresAmount" exact="0" />
										<do_if value="$waresAmount lt $maxWaresAmount">
											<set_value name="$addWaresAmount" exact="[$wareNum, $maxWaresAmount-$waresAmount].min" />
										</do_if>
										<do_if value="$addWaresAmount gt 0">
											<do_if value="$_SingleLog_1 == 0 and $waresAmount == 0">
												<set_value name="$addWaresAmount" exact="$addWaresAmount*120" />
											</do_if>
											<add_cargo object="$Station" ware="$ware" exact="$addWaresAmount" />
										</do_if>
									</do_for_each>
								</do_if>
							</actions>
						</library>
					</cues>
				</cue>
			</cues>
		</mdscript>
	</replace>
</diff>